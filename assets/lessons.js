(async function(){const c=document.getElementById('lessons');try{const r=await fetch('data/lessons.json',{cache:'no-store'});const L=await r.json();if(!Array.isArray(L)||!L.length){c.innerHTML='<p>No lessons yet. Add entries to <code>data/lessons.json</code>.</p>';return;}for(const l of L){const card=document.createElement('article');card.className='lesson-card';card.innerHTML=`<h3>${l.title}</h3><p class="muted">${l.description??''}</p>`;if(l.video?.type==='file'){const v=document.createElement('video');v.controls=true;v.preload='metadata';v.src=l.video.src;v.setAttribute('playsinline','');card.appendChild(v);}else if(l.video?.type==='youtube'){const i=document.createElement('iframe');i.width='640';i.height='360';i.src=`https://www.youtube.com/embed/${l.video.id}`;i.title=l.title;i.frameBorder='0';i.allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';i.allowFullscreen=true;card.appendChild(i);}else if(l.video?.type==='cloudflare-stream'){const i=document.createElement('iframe');i.width='640';i.height='360';i.src=`https://iframe.videodelivery.net/${l.video.uid}`;i.title=l.title;i.allow='accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share';i.allowFullscreen=true;card.appendChild(i);}c.appendChild(card);}}catch(e){c.innerHTML='<p>Failed to load lessons. Check <code>data/lessons.json</code>.</p>';console.error(e);}})();